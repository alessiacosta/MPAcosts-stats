---
title: "Ch3-MPAcosts"
---

# Loading packages needed fro the project

```{r}
library(readr)
library(ggplot2)
library(rnaturalearth) # to make a world map
library(rnaturalearthdata) # data for world map with polygons of the coastline only
library(dplyr)
library(sf)
library(ggspatial) # to add spatial elements to a ggplot map
library(car)
```

# Making a map of the MPAs I found data for

## Loading the map data

```{r}
#upload the right data
fig1 <- read_csv("../Data/fig1.csv")
```

## Making global map with my data

```{r}
# Get world map data
world <- ne_countries(scale = "medium", returnclass = "sf")

png("Map1.png", width = 2500, height = 2000, res = 150)
# Create the world map
# Load the coastline data from rnaturalearth
coastline_data <- ne_coastline(scale = "medium", returnclass = "sf")

# Create the plot
ggplot() +  
  # Plot countries in a very light grey
  geom_sf(data = world, fill = "grey95", color = NA) +  
  # Overlay the coastline in black
  geom_sf(data = coastline_data, color = "black", fill = NA) +  
  # Plot your data points
  geom_point(data = fig1, aes(x = Longitude, y = Latitude), color = "#008080", size = 4) +  
  # Set coordinate system
  coord_sf() +
  # Adjust theme
  theme_minimal() +  
  theme(
    axis.text = element_text(size = 24),
    axis.title = element_blank(),  # Removes axis titles
    axis.line.x = element_line(color = "black", size = 0.5),
    axis.line.y = element_line(color = "black", size = 0.5),
    axis.ticks = element_line(color = "black", size = 0.5),
    panel.grid = element_blank()
  )
dev.off()

```





# Statistics

## Loading the data
```{r}
#loading the data
data <- read_csv("../Data/ch3data.csv")
#setting up the data

```


## Data exploration
```{r}


```

```{r}
#model
# Linear regression model with the specified predictors
model <- lm(Cost_km ~ Cost_class + Cost_type + Fully_protected + GDP_pc + GDP_class, data = data)

# View the summary of the model
summary(model)
vif(model)

#plot
plot(model)

# Plot the residuals to check for normality (Gaussian distribution)
#par(mfrow = c(1, 2))  # Set up a 2-panel plot
#plot(model$fitted.values, model$residuals, main = "Residuals vs Fitted", xlab = "Fitted Values", ylab = "Residuals")
#hist(model$residuals, breaks = 30, main = "Histogram of Residuals", xlab = "Residuals", col = "lightblue", border = "black")

```












